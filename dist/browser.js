var CDFormLibrary=(()=>{var _={mask:/^.*$/,preprocessors:[],postprocessors:[],plugins:[],overwriteMode:"shift"},G=class{constructor(){this.now=null,this.past=[],this.future=[]}undo(){let e=this.past.pop();e&&this.now&&(this.future.push(this.now),this.updateElement(e,"historyUndo"))}redo(){let e=this.future.pop();e&&this.now&&(this.past.push(this.now),this.updateElement(e,"historyRedo"))}updateHistory(e){if(!this.now){this.now=e;return}let n=this.now.value!==e.value,o=this.now.selection.some((s,r)=>s!==e.selection[r]);!n&&!o||(n&&(this.past.push(this.now),this.future=[]),this.now=e)}updateElement(e,n){this.now=e,this.updateElementState(e,{inputType:n,data:null})}};function Te(t,...e){return e.every(({value:n})=>n===t.value)}function B(t,...e){return e.every(({value:n,selection:o})=>n===t.value&&o[0]===t.selection[0]&&o[1]===t.selection[1])}function oe({value:t,selection:e},n,o){let[s,r]=e,i=typeof o=="function"?o({value:t,selection:e}):o;return{value:t,selection:i==="replace"?[s,Math.max(s+n.length,r)]:[s,r]}}function N(t){return typeof t=="string"}function se(t,e,n,o){let s="";for(let r=e.length;r<t.length;r++){let i=t[r]||"",l=o?.value[r]===i;if(!N(i)||i===n&&!l)return s;s+=i}return s}function le(t,e){return Array.isArray(e)?t.length===e.length&&Array.from(t).every((n,o)=>{let s=e[o]||"";return N(s)?n===s:n.match(s)}):e.test(t)}function _e(t,e,n){let o=null,s=null,r=Array.from(t.value).reduce((l,c,a)=>{let u=se(e,l,c,n),d=l+u,g=e[d.length]||"";return o===null&&a>=t.selection[0]&&(o=d.length),s===null&&a>=t.selection[1]&&(s=d.length),N(g)?d+g:c.match(g)?d+c:u.startsWith(c)?d:l},""),i=se(e,r,"",n);return{value:le(r+i,e)?r+i:r,selection:[o??r.length,s??r.length]}}function Ne({value:t,selection:e},n){let[o,s]=e,r=o,i=s,l=Array.from(t).reduce((c,a,u)=>{let d=c+a;return o===u&&(r=c.length),s===u&&(i=c.length),d.match(n)?d:c},"");return{value:l,selection:[Math.min(r,l.length),Math.min(i,l.length)]}}function C(t,e,n=null){if(le(t.value,e))return t;let{value:o,selection:s}=Array.isArray(e)?_e(t,e,n):Ne(t,e);return{selection:s,value:Array.isArray(e)?o.slice(0,e.length):o}}function re(t,e){if(!Array.isArray(e))return t;let[n,o]=t.selection,s=[],r=Array.from(t.value).reduce((i,l,c)=>{let a=e[c]||"";return c===n&&s.push(i.length),c===o&&s.push(i.length),N(a)&&a===l?i:i+l},"");return s.length<2&&s.push(...new Array(2-s.length).fill(r.length)),{value:r,selection:[s[0],s[1]]}}var M=class{constructor(e,n){this.maskOptions=n,this.unmaskInitialState={value:"",selection:[0,0]},this.value="",this.selection=[0,0];let o=this.getMaskExpression(e),{value:s,selection:r}=C(e,o);this.unmaskInitialState=re({value:s,selection:r},o),this.value=s,this.selection=r}addCharacters(e){let{value:n,selection:o,maskOptions:s}=this,r={value:n,selection:o},{selection:[i,l]}=oe(r,e,s.overwriteMode),c=this.getMaskExpression({value:n.slice(0,i)+e+n.slice(l),selection:[i+e.length,i+e.length]}),[a,u]=oe(this.unmaskInitialState,e,s.overwriteMode).selection,d=this.unmaskInitialState.value.slice(0,a)+e,g=d.length,m=C({value:d+this.unmaskInitialState.value.slice(u),selection:[g,g]},c,r),p=n.slice(0,i),f=C({value:d,selection:[g,g]},c,r);if(f.value===p||f.value.length<p.length&&re(f,c).value===this.unmaskInitialState.value.slice(0,a)||B(this,m))throw new Error("Invalid mask value");this.value=m.value,this.selection=m.selection}deleteCharacters(){let[e,n]=this.selection;if(e===n||!n)return;let{value:o}=this,s=this.getMaskExpression({value:o.slice(0,e)+o.slice(n),selection:[e,e]}),r={value:o},[i,l]=this.unmaskInitialState.selection,c=this.unmaskInitialState.value.slice(0,i)+this.unmaskInitialState.value.slice(l),a=C({value:c,selection:[i,i]},s,r);this.value=a.value,this.selection=a.selection}getMaskExpression(e){let{mask:n}=this.maskOptions;return typeof n=="function"?n(e):n}},R=class{constructor(e){this.element=e,this.listeners=[]}listen(e,n,o){let s=n;this.element.addEventListener(e,s,o),this.listeners.push(()=>this.element.removeEventListener(e,s,o))}destroy(){this.listeners.forEach(e=>e())}},E={CTRL:1,ALT:2,SHIFT:4,META:8},D={Y:89,Z:90};function x(t,e,n){return t.ctrlKey===!!(e&E.CTRL)&&t.altKey===!!(e&E.ALT)&&t.shiftKey===!!(e&E.SHIFT)&&t.metaKey===!!(e&E.META)&&t.keyCode===n}function Pe(t){return x(t,E.CTRL,D.Y)||x(t,E.CTRL|E.SHIFT,D.Z)||x(t,E.META|E.SHIFT,D.Z)}function ke(t){return x(t,E.CTRL,D.Z)||x(t,E.META,D.Z)}function q(t,e){var n;let o=t.value;if(typeof e=="string")t.value=e;else{let[s,r]=e.selection;t.value=e.value,t.matches(":focus")&&((n=t.setSelectionRange)===null||n===void 0||n.call(t,s,r))}t.value!==o&&t.dispatchEvent(new Event("input",{bubbles:!0}))}function Oe({value:t,selection:e},n){let[o,s]=e;if(o!==s)return[o,s];let r=n?t.slice(o).indexOf(`
`)+1||t.length:t.slice(0,s).lastIndexOf(`
`)+1;return[n?o:r,n?r:s]}function Fe({value:t,selection:e},n){let[o,s]=e;return o!==s?[o,s]:(n?[o,s+1]:[o-1,s]).map(i=>Math.min(Math.max(i,0),t.length))}var Ve=/\s+$/g,He=/^\s+/g,ie=/\s/;function je({value:t,selection:e},n){let[o,s]=e;if(o!==s)return[o,s];if(n){let c=t.slice(o),[a]=c.match(He)||[""],u=c.trimStart().search(ie);return[o,u!==-1?o+a.length+u:t.length]}let r=t.slice(0,s),[i]=r.match(Ve)||[""],l=r.trimEnd().split("").reverse().findIndex(c=>ie.exec(c));return[l!==-1?s-i.length-l:0,s]}function T(t=[]){return(e,...n)=>t.reduce((o,s)=>Object.assign(Object.assign({},o),s(o,...n)),e)}function ae(t,e){let n=Object.assign(Object.assign({},_),e),o=T(n.preprocessors),s=T(n.postprocessors),r=typeof t=="string"?{value:t,selection:[0,0]}:t,{elementState:i}=o({elementState:r,data:""},"validation"),l=new M(i,n),{value:c,selection:a}=s(l,r);return typeof t=="string"?c:{value:c,selection:a}}function Ge(){return t=>{let e=new R(t),n=!1,o,s=t.value;return e.listen("keydown",({key:r})=>{n=r==="Unidentified"}),e.listen("beforeinput",r=>{o=r,s=t.value}),e.listen("input",r=>{n&&o.defaultPrevented&&o.inputType==="deleteContentBackward"&&r.inputType==="deleteContentBackward"&&(t.value=s)},{capture:!0}),()=>e.destroy()}}var j=" ";function Be(){let t="",e=0,n=null,o=!1;return s=>{let r=new R(s);return r.listen("beforeinput",i=>{var l,c;let{value:a,selectionStart:u,selectionEnd:d}=s,g=n?.inputType==="insertText"&&n?.data===j&&!a.slice(0,Number(d)).endsWith(j);i.inputType==="insertText"&&i.data===`.${j}`&&(n?.inputType==="deleteContentBackward"&&o?(s.value=t,(l=s.setSelectionRange)===null||l===void 0||l.call(s,e,e)):g&&((c=s.setSelectionRange)===null||c===void 0||c.call(s,u,u))),o=g,n=i,t=a,e=Number((g?e:d)===a.length?d:u)}),()=>r.destroy()}}var qe=[Be(),Ge()],L=class extends G{constructor(e,n){super(),this.element=e,this.maskitoOptions=n,this.isTextArea=this.element.nodeName==="TEXTAREA",this.eventListener=new R(this.element),this.options=Object.assign(Object.assign({},_),this.maskitoOptions),this.upcomingElementState=null,this.preprocessor=T(this.options.preprocessors),this.postprocessor=T(this.options.postprocessors),this.teardowns=this.options.plugins.concat(qe).map(o=>o(this.element,this.options)),this.updateHistory(this.elementState),this.eventListener.listen("keydown",o=>{if(Pe(o))return o.preventDefault(),this.redo();if(ke(o))return o.preventDefault(),this.undo()}),this.eventListener.listen("beforeinput",o=>{var s,r,i;let l=o.inputType.includes("Forward");switch(this.updateHistory(this.elementState),o.inputType){case"deleteByCut":case"deleteContentBackward":case"deleteContentForward":return this.handleDelete({event:o,isForward:l,selection:Fe(this.elementState,l)});case"deleteHardLineBackward":case"deleteHardLineForward":case"deleteSoftLineBackward":case"deleteSoftLineForward":return this.handleDelete({event:o,isForward:l,selection:Oe(this.elementState,l),force:!0});case"deleteWordBackward":case"deleteWordForward":return this.handleDelete({event:o,isForward:l,selection:je(this.elementState,l)});case"historyRedo":return o.preventDefault(),this.redo();case"historyUndo":return o.preventDefault(),this.undo();case"insertCompositionText":return;case"insertLineBreak":case"insertParagraph":return this.handleEnter(o);case"insertReplacementText":return;case"insertFromDrop":case"insertFromPaste":case"insertText":default:return this.handleInsert(o,(i=(s=o.data)!==null&&s!==void 0?s:(r=o.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain"))!==null&&i!==void 0?i:"")}}),this.eventListener.listen("input",()=>{this.upcomingElementState&&!B(this.upcomingElementState,this.elementState)&&this.updateElementState(this.upcomingElementState),this.upcomingElementState=null},{capture:!0}),this.eventListener.listen("input",({inputType:o})=>{o!=="insertCompositionText"&&(this.ensureValueFitsMask(),this.updateHistory(this.elementState))}),this.eventListener.listen("compositionend",()=>{this.ensureValueFitsMask(),this.updateHistory(this.elementState)})}destroy(){this.eventListener.destroy(),this.teardowns.forEach(e=>e?.())}updateElementState({value:e,selection:n},o){let s=this.elementState.value;this.updateValue(e),this.updateSelectionRange(n),o&&s!==e&&this.dispatchInputEvent(o)}get elementState(){let{value:e,selectionStart:n,selectionEnd:o}=this.element;return{value:e,selection:[n??0,o??0]}}get maxLength(){let{maxLength:e}=this.element;return e===-1?1/0:e}updateSelectionRange([e,n]){var o;let{element:s}=this;s.matches(":focus")&&(s.selectionStart!==e||s.selectionEnd!==n)&&((o=s.setSelectionRange)===null||o===void 0||o.call(s,e,n))}updateValue(e){(this.element.value!==e||this.element.isContentEditable)&&(this.element.value=e)}ensureValueFitsMask(){this.updateElementState(ae(this.elementState,this.options),{inputType:"insertText",data:null})}dispatchInputEvent(e={inputType:"insertText",data:null}){globalThis.InputEvent&&this.element.dispatchEvent(new InputEvent("input",Object.assign(Object.assign({},e),{bubbles:!0,cancelable:!1})))}handleDelete({event:e,selection:n,isForward:o}){let s={value:this.elementState.value,selection:n},{elementState:r}=this.preprocessor({elementState:s,data:""},o?"deleteForward":"deleteBackward"),i=new M(r,this.options);i.deleteCharacters();let l=this.postprocessor(i,s);if(Te(s,r,i,l)){let[c,a]=r.selection;return e.preventDefault(),this.updateSelectionRange(o?[a,a]:[c,c])}this.upcomingElementState=l}handleInsert(e,n){let{options:o,maxLength:s,elementState:r}=this,[i,l]=r.selection,{elementState:c,data:a=n}=this.preprocessor({data:n,elementState:r},"insert"),u=new M(c,o);try{u.addCharacters(a)}catch{return e.preventDefault()}this.upcomingElementState=this.clampState(this.postprocessor(u,r)),r.value.length>=s&&i===l&&(o.overwriteMode==="replace"&&!B(this.upcomingElementState,r)?this.dispatchInputEvent({inputType:"insertText",data:n}):this.upcomingElementState=null)}handleEnter(e){(this.isTextArea||this.element.isContentEditable)&&this.handleInsert(e,`
`)}clampState({value:e,selection:n}){let[o,s]=n,r=this.maxLength;return{value:e.slice(0,r),selection:[Math.min(o,r),Math.min(s,r)]}}};function ge(t,e,n){let o=Math.min(Number(n),Math.max(Number(e),Number(t)));return t instanceof Date?new Date(o):o}function We(t){return t.replaceAll(/\W/g,"").length}var me={day:31,month:12,year:9999};var Ue=new Date("0001-01-01T00:00"),ze=new Date("9999-12-31T23:59:59.999"),W={hours:23,minutes:59,seconds:59,milliseconds:999},fe={hours:0,minutes:0,seconds:0,milliseconds:0},$="\xA0";var Ze=":",Ye="\uFF1A",k=new RegExp(`[${$}APM]+$`,"g"),O=new RegExp(`${$}[AP]M$`,"g"),U=[":","."],pe={hours:2,minutes:2,seconds:2,milliseconds:3};var he=t=>{var e,n,o,s,r,i;return{day:(n=(e=t.match(/d/g))===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0,month:(s=(o=t.match(/m/g))===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0,year:(i=(r=t.match(/y/g))===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0}};function Ke(t){return{day:String(t.getDate()).padStart(2,"0"),month:String(t.getMonth()+1).padStart(2,"0"),year:String(t.getFullYear()).padStart(4,"0"),hours:String(t.getHours()).padStart(2,"0"),minutes:String(t.getMinutes()).padStart(2,"0"),seconds:String(t.getSeconds()).padStart(2,"0"),milliseconds:String(t.getMilliseconds()).padStart(3,"0")}}var Je=["day","month","year"];function Xe(t){return[...Je].sort((e,n)=>t.indexOf(e[0])>t.indexOf(n[0])?1:-1)}function Qe(t,e){return t.length<e.length?!1:t.split(/\D/).every(n=>!/^0+$/.exec(n))}function ve(t,e,n){let o=We(e);return t.replace(n,"").match(new RegExp(`(\\D*\\d[^\\d\\s]*){1,${o}}`,"g"))||[]}function z(t,e){let n=e.replaceAll(/[^dmy]/g,""),o=t.replaceAll(/\D+/g,""),s={day:o.slice(n.indexOf("d"),n.lastIndexOf("d")+1),month:o.slice(n.indexOf("m"),n.lastIndexOf("m")+1),year:o.slice(n.indexOf("y"),n.lastIndexOf("y")+1)};return Object.fromEntries(Object.entries(s).filter(([r,i])=>!!i).sort(([r],[i])=>e.toLowerCase().indexOf(r.slice(0,1))>e.toLowerCase().indexOf(i.slice(0,1))?1:-1))}function et(t,e){var n,o,s,r,i,l,c;let a=((n=t.year)===null||n===void 0?void 0:n.length)===2?`20${t.year}`:t.year,u=new Date(Number(a??"0"),Number((o=t.month)!==null&&o!==void 0?o:"1")-1,Number((s=t.day)!==null&&s!==void 0?s:"1"),Number((r=e?.hours)!==null&&r!==void 0?r:"0"),Number((i=e?.minutes)!==null&&i!==void 0?i:"0"),Number((l=e?.seconds)!==null&&l!==void 0?l:"0"),Number((c=e?.milliseconds)!==null&&c!==void 0?c:"0"));return u.setFullYear(Number(a??"0")),u}var Ee=", ";function I({day:t,month:e,year:n,hours:o,minutes:s,seconds:r,milliseconds:i},{dateMode:l,dateTimeSeparator:c=Ee,timeMode:a}){var u;let d=((u=l.match(/y/g))===null||u===void 0?void 0:u.length)===2?n?.slice(-2):n;return(l+(a?c+a:"")).replaceAll(/d+/g,t??"").replaceAll(/m+/g,e??"").replaceAll(/y+/g,d??"").replaceAll(/H+/g,o??"").replaceAll("MSS",i??"").replaceAll(/M+/g,s??"").replaceAll(/S+/g,r??"").replaceAll(/^\D+/g,"").replaceAll(/\D+$/g,"")}function tt({dateString:t,dateModeTemplate:e,dateSegmentsSeparator:n,offset:o,selection:[s,r]}){var i,l;let c=z(t,e),a=Object.entries(c),u=Xe(e),d={};for(let p=0;p<a.length;p++){let[f,h]=a[p],v=I(d,{dateMode:e}),y=me[f],w=v.length&&n.length,b=o+v.length+w+he(e)[f],A=b>=s&&b===r;if(A&&Number(h)>Number(y)){let S=u[u.indexOf(f)+1];if(!S||S==="year")return{validatedDateString:"",updatedSelection:[s,r]};d[f]=`0${h.slice(0,-1)}`,a[p+1]=[S,h.slice(-1)+((l=(i=a[p+1])===null||i===void 0?void 0:i[1])!==null&&l!==void 0?l:"").slice(1)];continue}if(A&&Number(h)<1)return{validatedDateString:"",updatedSelection:[s,r]};d[f]=h}let g=I(d,{dateMode:e}),m=g.length-t.length;return{validatedDateString:g,updatedSelection:[s+m,r+m]}}function V(t){return t}function ye(){}var we=/[\\^$.*+?()[\]{}|]/g,nt=new RegExp(we.source);function H(t){return t&&nt.test(t)?t.replaceAll(we,String.raw`\$&`):t}function ot(t,e){let n="";for(let o=0;o<t.length;o++){if(t[o]!==e[o])return n;n+=t[o]}return n}var st=/^0+$/;function F(t,e,n=0){let o=t.padEnd(e.length,"0");if(Number(o)<=Number(e))return{validatedSegmentValue:t,prefixedZeroesCount:n};if(o.endsWith("0"))return F(`0${t.slice(0,e.length-1)}`,e,n+1);let s=t.slice(0,e.length-1);return st.exec(s)?{validatedSegmentValue:"",prefixedZeroesCount:n}:F(`${s}0`,e,n)}function ce(t){return t.replaceAll(new RegExp(Ye,"g"),Ze)}function ue(t){return t.replaceAll(/[０-９]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248))}function rt(){return({elementState:t,data:e})=>{let{value:n,selection:o}=t;return{elementState:{selection:o,value:ce(n)},data:ce(e)}}}function it({dateModeTemplate:t,dateSegmentSeparator:e,splitFn:n,uniteFn:o}){return({value:s,selection:r})=>{var i;let[l,c]=r,{dateStrings:a,restPart:u=""}=n(s),d=[],g=0;a.forEach(p=>{let f=z(p,t),v=Object.entries(f).reduce((y,[w,b])=>{let{validatedSegmentValue:A,prefixedZeroesCount:S}=F(b,`${me[w]}`);return g+=S,Object.assign(Object.assign({},y),{[w]:A})},{});d.push(I(v,{dateMode:t}))});let m=o(d,s)+(!((i=a[a.length-1])===null||i===void 0)&&i.endsWith(e)?e:"")+u;return g&&m.slice(c+g,c+g+e.length)===e&&(g+=e.length),{selection:[l+g,c+g],value:m}}}function be(){return({elementState:t,data:e})=>{let{value:n,selection:o}=t;return{elementState:{selection:o,value:ue(n)},data:ue(e)}}}function lt(t){return Array.from(t.replace(" AA","")).map(e=>U.includes(e)?e:/\d/).concat(t.includes("AA")?[$,/[AP]/i,/M/i]:[])}function at(t,e){return Object.fromEntries(Object.entries(t).map(([n,o])=>[n,e(String(o),pe[n])]))}function ct(t){return at(t,(e,n)=>e.padStart(n,"0"))}var de={HH:"hours",MM:"minutes",SS:"seconds",MSS:"milliseconds"};function Ae(t,e){let n=t.replaceAll(/\D+/g,""),o=0;return Object.fromEntries(e.split(/\W/).filter(s=>de[s]).map(s=>{let r=n.slice(o,o+s.length);return o+=s.length,[de[s],r]}))}var ut=/^\D*/,dt=/\D*$/;function gt({hours:t="",minutes:e="",seconds:n="",milliseconds:o=""}){return`${t}:${e}:${n}.${o}`.replace(ut,"").replace(dt,"")}var mt=new RegExp(`[${U.map(H).join("")}]$`);function ft({value:t,selection:e},{mode:n,timeSegmentMaxValues:o=W}){let[s,r]=e,i=Ae(t,n),l=Object.entries(i),c=ct(o),a={},u=0;for(let[v,y]of l){let w=c[v],{validatedSegmentValue:b,prefixedZeroesCount:A}=F(y,String(w));u+=A,a[v]=b}let[d=""]=t.match(/^\D+(?=\d)/g)||[],[g=""]=t.match(/\D+$/g)||[],m=d+gt(a)+g,p=Math.max(m.length-t.length-u,0),f=s+u+p,h=r+u+p;return f===h&&u&&m.slice(0,h+1).match(mt)&&(f++,h++),{value:m,selection:[f,h]}}function pt({timeMode:t,timeSegmentMinValues:e=fe,timeSegmentMaxValues:n=W,parseValue:o=s=>({timeString:s})}){let s=new RegExp(`[^\\d${U.map(H).join("")}]+`);return({elementState:r,data:i},l)=>{if(l!=="insert")return{elementState:r,data:i};let{value:c,selection:a}=r,[u,d]=a,g=i.replace(s,""),m=d+g.length,p=c.slice(0,u)+g+c.slice(m),{timeString:f,restValue:h=""}=o(p),v=Object.entries(Ae(f,t)),y=h.length;for(let[w,b]of v){let A=e[w],S=n[w],te=Number(b),ne=y+pe[w];if(ne>=u&&ne<=m&&te!==ge(te,A,S))return{elementState:r,data:""};y+=b.length+1}return{elementState:r,data:i}}}function ht(t){if(!t.includes("AA"))return V;let e=/^[AP]$/gi;return({elementState:n,data:o})=>{let{value:s,selection:r}=n,i=s.toUpperCase(),l=o.toUpperCase();return i.match(O)&&l.match(e)?{elementState:{value:i.replaceAll(O,""),selection:r},data:`${l}M`}:{elementState:{selection:r,value:i},data:l}}}function vt(t){return t.includes("AA")?({value:e,selection:n},o)=>{if(!e.match(k)||e.match(O))return{value:e,selection:n};let[s,r]=n;if(o.value.match(O)){let c=e.replace(k,"");return{value:c,selection:[Math.min(s,c.length),Math.min(r,c.length)]}}let i=`${$}${e.includes("P")?"P":"A"}M`,l=e.replace(k,c=>c!==$?i:c);return{value:l,selection:r>=l.indexOf(i)?[l.length,l.length]:n}}:V}function Et(t,e){let n=he(e);return Object.fromEntries(Object.entries(t).map(([o,s])=>{let r=n[o];return[o,s.length===r&&/^0+$/.exec(s)?"1".padStart(r,"0"):s]}))}var yt="1972";function wt({dateModeTemplate:t,min:e=Ue,max:n=ze,rangeSeparator:o="",dateSegmentSeparator:s="."}){return({value:r,selection:i})=>{let l=o&&r.endsWith(o),c=ve(r,t,o),a="";for(let u of c){a+=a?o:"";let d=z(u,t);if(!Qe(u,t)){let p=Et(d,t),f=I(p,{dateMode:t}),h=u.endsWith(s)?s:"";a+=f+h;continue}let g=et(Object.assign({year:yt},d)),m=ge(g,e,n);a+=I(Ke(m),{dateMode:t})}return{selection:i,value:a+(l?o:"")}}}function bt({dateModeTemplate:t,dateSegmentsSeparator:e,rangeSeparator:n="",dateTimeSeparator:o=Ee}){return({elementState:s,data:r})=>{let i=t.split(e),l=r.includes(o),c=r.slice(0,l?r.indexOf(o):1/0).split(/\D/).filter(Boolean);if(!c.length||c.length%i.length!==0)return{elementState:s,data:r};let a=c.reduce((u,d,g)=>{var m;let p=(m=i[g%i.length])!==null&&m!==void 0?m:"",f=Math.trunc(g/i.length),h=g%i.length===i.length-1;return u[f]||(u[f]=""),u[f]+=h?d:`${d.padStart(p.length,"0")}${e}`,u},[]);return{elementState:s,data:l?`${a[0]}${r.slice(r.indexOf(o))}`:a.join(n)}}}function At(t){let e=new RegExp(`${H(t)}$`);return t?({value:n,selection:o},s)=>{if(!n&&!s.value.endsWith(t))return{value:n,selection:o};if(!n.endsWith(t)&&!s.value.endsWith(t))return{selection:o,value:n+t};let r=s.value.replace(e,""),i=s.selection[1]>r.length,l=ot(r,n);return{selection:o,value:Array.from(t).reverse().reduce((c,a,u)=>{let d=c.length-1-u,g=l[d]===a&&i;return c[d]!==a||g?c.slice(0,d+1)+a+c.slice(d+1):c},n)}}:V}function St(t){return t?({value:e,selection:n},o)=>{if(e.startsWith(t)||!e&&!o.value.startsWith(t))return{value:e,selection:n};let[s,r]=n,i=Array.from(t).reduce((c,a,u)=>c[u]===a?c:c.slice(0,u)+a+c.slice(u),e),l=i.length-e.length;return{selection:[s+l,r+l],value:i}}:V}function $t({dateModeTemplate:t,dateSegmentsSeparator:e,rangeSeparator:n=""}){return({elementState:o,data:s})=>{let{value:r,selection:i}=o;if(s===e)return{elementState:o,data:i[0]===r.length?s:""};if(!s.replaceAll(/\D/g,""))return{elementState:o,data:s};let l=s.replaceAll(new RegExp(`[^\\d${H(e)}${n}]`,"g"),""),[c,a]=i,u=a+s.length,d=r.slice(0,c)+l+r.slice(u),g=ve(d,t,n),m="",p=!!n&&d.includes(n);for(let h of g){let{validatedDateString:v,updatedSelection:y}=tt({dateString:h,dateModeTemplate:t,dateSegmentsSeparator:e,offset:m.length,selection:[c,u]});if(h&&!v)return{elementState:o,data:""};u=y[1],m+=p&&!m?v+n:v}let f=m.slice(c,u);return{elementState:{selection:i,value:m.slice(0,c)+f.split(e).map(h=>"0".repeat(h.length)).join(e)+m.slice(u)},data:f}}}function Dt(t){return t<0?ye:e=>{let n=o=>{let s=Number(e.selectionStart),r=e.value.toUpperCase();if(o.key!=="ArrowUp"&&o.key!=="ArrowDown"||s<t)return;o.preventDefault();let i=r.includes("A")?"P":r.includes("P")||o.key==="ArrowUp"?"A":"P",l=`${$}${i}M`;q(e,{value:r.length===t?r+l:r.replace(k,l),selection:[s,s]})};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)}}function xt({step:t,fullMode:e,timeSegmentMaxValues:n}){let o=Mt(e);return t<=0?ye:s=>{let r=i=>{var l;if(i.key!=="ArrowUp"&&i.key!=="ArrowDown")return;i.preventDefault();let c=(l=s.selectionStart)!==null&&l!==void 0?l:0,a=Rt({segmentsIndexes:o,selectionStart:c});if(!a)return;let u=Lt({selection:o.get(a),value:s.value,toAdd:i.key==="ArrowUp"?t:-t,max:n[a]});q(s,{value:u,selection:[c,c]})};return s.addEventListener("keydown",r),()=>s.removeEventListener("keydown",r)}}function Mt(t){return new Map([["hours",P(t,"HH")],["milliseconds",P(t,"MSS")],["minutes",P(t,"MM")],["seconds",P(t,"SS")]])}function P(t,e){let n=t.indexOf(e);return n===-1?[-1,-1]:[n,n+e.length]}function Rt({segmentsIndexes:t,selectionStart:e}){for(let[n,o]of t.entries()){let[s,r]=o;if(s<=e&&e<=r)return n}return null}function Lt({selection:t,value:e,toAdd:n,max:o}){let[s,r]=t,i=Number(e.slice(s,r).padEnd(r-s,"0")),l=It(i+n,o+1);return e.slice(0,s)+String(l).padStart(r-s,"0")+e.slice(r,e.length)}function It(t,e){return t<0&&(t+=Math.floor(Math.abs(t)/e+1)*e),t%e}function Se(t=""){let e=(n,[o,s])=>s>=n.length-t.length;return({elementState:n},o)=>{let{value:s,selection:r}=n;if(!s||e(s,r))return{elementState:n};let[i,l]=r,c=s.slice(i,l).replaceAll(/\d/g,"0"),a=s.slice(0,i)+c+s.slice(l);return c.replaceAll(/\D/g,"")?o==="validation"||o==="insert"&&i===l?{elementState:{selection:r,value:a}}:{elementState:{selection:o==="deleteBackward"||o==="insert"?[i,i]:[l,l],value:a}}:{elementState:n}}}function $e({mode:t,separator:e=".",max:n,min:o}){let s=t.split("/").join(e);return Object.assign(Object.assign({},_),{mask:Array.from(s).map(r=>e.includes(r)?r:/\d/),overwriteMode:"replace",preprocessors:[be(),Se(),bt({dateModeTemplate:s,dateSegmentsSeparator:e}),$t({dateModeTemplate:s,dateSegmentsSeparator:e})],postprocessors:[it({dateModeTemplate:s,dateSegmentSeparator:e,splitFn:r=>({dateStrings:[r]}),uniteFn:([r=""])=>r}),wt({min:o,max:n,dateModeTemplate:s,dateSegmentSeparator:e})]})}var jt=Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",year:"numeric"});function De({mode:t,timeSegmentMaxValues:e={},timeSegmentMinValues:n={},step:o=0,prefix:s="",postfix:r=""}){let i=t.includes("AA"),l=Object.assign(Object.assign(Object.assign({},W),i?{hours:12}:{}),e),c=Object.assign(Object.assign(Object.assign({},fe),i?{hours:1}:{}),n),a=[...s,...lt(t)];return{mask:r?({value:u})=>Ct(a,u).concat(...r):a,preprocessors:[be(),rt(),Se(r),ht(t),pt({timeMode:t,timeSegmentMinValues:c,timeSegmentMaxValues:l})],postprocessors:[vt(t),u=>ft(u,{mode:t,timeSegmentMaxValues:l}),St(s),At(r)],plugins:[xt({fullMode:t,step:o,timeSegmentMaxValues:l}),Dt(t.indexOf("AA"))],overwriteMode:"replace"}}function Ct(t,e){let n=Math.min(e.replaceAll(/\D/g,"").length,t.filter(s=>typeof s!="string").length)||1,o=t.findIndex(s=>typeof s!="string"&&!--n)+1;return t.slice(0,o)}var Re="0.1.86";function Le(t){let e=t.toLowerCase().trim().replace(/\s+/g," ");return e==="date:mmddyyyy"?{type:"date",pattern:"mmddyyyy"}:e==="date:ddmmyyyy"?{type:"date",pattern:"ddmmyyyy"}:e==="time:hhmm am"||e==="time:hhmm"?{type:"time",pattern:"hhmm",defaultMeridiem:"AM"}:e==="time:hhmm pm"?{type:"time",pattern:"hhmm",defaultMeridiem:"PM"}:e==="percent"?{type:"percent",pattern:"percent"}:null}function Ie(t){if(t.type==="date"){let e=t.pattern==="mmddyyyy"?"mm/dd/yyyy":"dd/mm/yyyy";return $e({mode:e,separator:"/"})}else{if(t.type==="time")return De({mode:"HH:MM AA"});if(t.type==="percent")return{mask:/^\d{0,3}(\.\d{0,2})?%?$/,preprocessors:[({elementState:e,data:n})=>{let o=e.value.replace("%",""),s=n.replace("%","");return{elementState:{...e,value:o},data:s}}],postprocessors:[({value:e,selection:n})=>e&&!e.endsWith("%")?{value:e+"%",selection:[n[0],n[1]]}:{value:e,selection:n}]}}return null}function Tt(t){let e=t.querySelectorAll("input[data-input]");console.log(`\u{1F4DD} Found ${e.length} inputs with data-input attributes`),e.forEach((n,o)=>{let s=n,r=s.getAttribute("data-input");if(console.log(`\u{1F4DD} Input ${o+1}: ${s.id||s.name} - data-input="${r}"`),!r)return;let i=Le(r);if(console.log(`\u{1F4DD} Config for ${s.id}:`,i),!i)return;let l=Ie(i);if(console.log(`\u{1F4DD} Maskito options created for ${s.id}:`,!!l),!l)return;let c=new L(s,l);console.log(`\u2705 Maskito initialized for ${s.id}`),s.dispatchEvent(new CustomEvent("cd:inputformat:bound",{bubbles:!0}));let a=s.value;s.addEventListener("input",()=>{let u=s.value;u!==a&&(s.dispatchEvent(new CustomEvent("cd:inputformat:changed",{bubbles:!0,detail:{raw:a,formatted:u}})),a=u)}),s.addEventListener("blur",()=>{let u=s.value.length===0||s.checkValidity();s.setAttribute("aria-invalid",(!u).toString()),u||s.dispatchEvent(new CustomEvent("cd:inputformat:invalid",{bubbles:!0}))}),s.__maskito=c})}function _t(){let t=document.querySelectorAll("[data-show-when]");console.log(`\u{1F441}\uFE0F Found ${t.length} elements with data-show-when`);let e=new Map;t.forEach((n,o)=>{let s=n.getAttribute("data-show-when");if(!s)return;let[r,i]=s.split("=").map(l=>l.trim());!r||i===void 0||(console.log(`\u{1F441}\uFE0F Wrapper ${o+1}: "${s}" - Looking for input group "${r}" with value "${i}"`),e.has(r)||e.set(r,new Set),e.get(r).add(n),xe(n,r,i))}),e.forEach((n,o)=>{document.querySelectorAll(`input[name="${o}"], select[name="${o}"], textarea[name="${o}"]`).forEach(r=>{r.addEventListener("change",()=>{n.forEach(i=>{let l=i.getAttribute("data-show-when");if(!l)return;let[,c]=l.split("=").map(a=>a.trim());xe(i,o,c)})})})})}function xe(t,e,n){let o=document.querySelectorAll(`input[name="${e}"], select[name="${e}"], textarea[name="${e}"]`);console.log(`\u{1F50D} Checking visibility for group "${e}": found ${o.length} inputs`);let s="";o.forEach(l=>{let c=l;if(c.type==="radio"||c.type==="checkbox"){let a=c;a.checked&&(s=a.value)}else s=c.value});let r=s===n;console.log(`\u{1F441}\uFE0F Group "${e}": current="${s}", target="${n}", shouldShow=${r}`);let i=t;r?(i.style.display="",i.removeAttribute("aria-hidden"),i.querySelectorAll("input, select, textarea, button, [tabindex]").forEach(c=>{c.removeAttribute("tabindex")}),t.dispatchEvent(new CustomEvent("form-wrapper-visibility:shown",{bubbles:!0}))):(i.style.display="none",i.setAttribute("aria-hidden","true"),i.querySelectorAll('input, select, textarea, button, [tabindex]:not([tabindex="-1"])').forEach(c=>{c.setAttribute("tabindex","-1")}),t.dispatchEvent(new CustomEvent("form-wrapper-visibility:hidden",{bubbles:!0})))}var J=new Map;function Nt(){console.log(`
\u{1F504} === DYNAMIC ROWS INITIALIZATION ===`);let t=document.querySelectorAll("[data-cd-repeat-group]");if(console.log("\u{1F50D} Found repeat groups:",t.length),t.length===0){console.warn("\u26A0\uFE0F No elements found with data-cd-repeat-group attribute");let e=document.querySelectorAll('[data*="repeat"], [data*="cd-repeat"]');console.log('\u{1F50D} Found elements with "repeat" in attributes:',e.length),e.length>0&&(console.log("\u{1F50D} First possible group:",e[0]),console.log("\u{1F50D} Its attributes:",Array.from(e[0].attributes).map(n=>`${n.name}="${n.value}"`)));return}t.forEach((e,n)=>{console.log(`
\u{1F3AF} Processing Group ${n+1}:`),console.log("\u{1F50D} Container element:",e.tagName,e.className);let o=e.getAttribute("data-cd-repeat-group");if(console.log("\u{1F50D} Group name:",o),!o){console.error("\u274C No group name found, skipping");return}let s=window.getComputedStyle(e),r=s.display==="none";if(console.log("\u{1F50D} Container display style:",s.display),console.log("\u{1F50D} Is hidden?",r),r){console.log("\u23ED\uFE0F Skipping hidden container (will reinitialize when shown)");return}console.log("\u2705 Proceeding to initialize group:",o),Ce(o,e)}),console.log(`
\u{1F3C1} Dynamic rows initialization complete`)}function Ce(t,e){let n=e.querySelector("[data-cd-repeat-template]"),o=e.querySelector("[data-cd-add-row]")||e.querySelector(`[data-cd-repeat-add="${t}"]`);if(!o&&(e.parentElement&&(o=e.parentElement.querySelector(`[data-cd-repeat-add="${t}"]`)||e.parentElement.querySelector("[data-cd-add-row]")),o||(o=document.querySelector(`[data-cd-repeat-add="${t}"]`)),!o)){let a=document.querySelectorAll("[data-cd-add-row], [data-cd-repeat-add]");for(let u of a){let d=u.getAttribute("data-cd-repeat-add"),g=u.getAttribute("data-cd-add-row");if(d===t||g===t||u.textContent?.toLowerCase().includes(t.toLowerCase())){o=u;break}}}let s=e.getAttribute("data-cd-name-pattern")||`${t}[{i}]`;if(console.log(`
\u{1F527} === INITIALIZING GROUP: "${t}" ===`),console.log("\u{1F50D} Container:",e.tagName,e.className),console.log("\u{1F50D} Template found:",!!n),console.log("\u{1F50D} Add button found:",!!o),o)console.log("\u{1F50D} Add button details:",{tag:o.tagName,class:o.className,"data-cd-repeat-add":o.getAttribute("data-cd-repeat-add"),"data-cd-add-row":o.getAttribute("data-cd-add-row"),href:o.getAttribute("href")});else{console.log("\u274C Add button search failed. Detailed debugging:");let a=e.querySelector("[data-cd-add-row]"),u=e.querySelector(`[data-cd-repeat-add="${t}"]`);console.log("\u{1F50D} Inside container [data-cd-add-row]:",!!a),console.log('\u{1F50D} Inside container [data-cd-repeat-add="'+t+'"]:',!!u);let d=e.parentElement?.querySelector(`[data-cd-repeat-add="${t}"]`),g=e.parentElement?.querySelector("[data-cd-add-row]");console.log('\u{1F50D} In parent [data-cd-repeat-add="'+t+'"]:',!!d),console.log("\u{1F50D} In parent [data-cd-add-row]:",!!g);let m=document.querySelector(`[data-cd-repeat-add="${t}"]`);console.log('\u{1F50D} In document [data-cd-repeat-add="'+t+'"]:',!!m);let p=document.querySelectorAll("[data-cd-add-row], [data-cd-repeat-add]");console.log("\u{1F50D} Total add buttons in document:",p.length),p.length>0&&(console.log("\u{1F50D} All add buttons found:"),p.forEach((f,h)=>{console.log(`  ${h+1}. ${f.tagName} - data-cd-repeat-add: "${f.getAttribute("data-cd-repeat-add")}" - data-cd-add-row: "${f.getAttribute("data-cd-add-row")}" - text: "${f.textContent?.trim()}"`)})),console.log("\u{1F50D} Container parent structure:"),console.log("  Container:",e.tagName,e.className),console.log("  Parent:",e.parentElement?.tagName,e.parentElement?.className),console.log("  Grandparent:",e.parentElement?.parentElement?.tagName,e.parentElement?.parentElement?.className)}if(n)console.log("\u2705 Template found:",n.tagName,n.className);else{console.log("\u{1F50D} No template found, searching for existing rows...");let a=e.querySelector("[data-cd-repeat-row]");if(console.log("\u{1F50D} First existing row found:",!!a),a){console.log("\u{1F50D} First row details:",{tag:a.tagName,class:a.className,"data-cd-repeat-row":a.getAttribute("data-cd-repeat-row")}),n=a.cloneNode(!0),n.setAttribute("data-cd-repeat-template","");let u=n.querySelectorAll("input, select, textarea");console.log("\u{1F50D} Clearing",u.length,"input values in template"),u.forEach(d=>{d.value=""}),e.insertBefore(n,a),console.log(`\u2705 Created template from first row for group "${t}"`)}else{console.log("\u{1F50D} Searching for any elements that might be rows...");let u=e.querySelectorAll('[data*="repeat-row"], [data*="cd-repeat"]');console.log("\u{1F50D} Found possible rows:",u.length),u.length>0&&(console.log("\u{1F50D} First possible row:",u[0]),console.log("\u{1F50D} Its attributes:",Array.from(u[0].attributes).map(d=>`${d.name}="${d.value}"`)))}}if(!n){console.error("\u274C No template available, cannot initialize group");return}console.log("\u{1F50D} Hiding template..."),n.style.display="none";let r=Array.from(e.querySelectorAll("[data-cd-repeat-row]"));console.log("\u{1F50D} Found existing rows:",r.length),r.forEach((a,u)=>{console.log(`\u{1F50D} Existing row ${u+1}:`,{tag:a.tagName,class:a.className,"data-cd-repeat-row":a.getAttribute("data-cd-repeat-row")})});let i=r.filter(a=>!a.hasAttribute("data-cd-repeat-template"));if(i.length>0){let a=i[0];a.style.display==="none"&&(console.log("\u{1F50D} Making first row visible..."),a.style.display="",a.removeAttribute("aria-hidden"))}let l={groupName:t,container:e,template:n,namePattern:s,rows:r,addButton:o};J.set(t,l),o?(console.log(`\u2795 Attaching add button listener for group "${t}"`),o.removeEventListener("click",Me),o.addEventListener("click",Me)):console.warn(`\u274C No add button found for group "${t}". Checked selectors: [data-cd-add-row], [data-cd-repeat-add="${t}"]`);let c=e.querySelectorAll("[data-cd-remove-row], [data-cd-repeat-remove]");console.log(`\u{1F517} Found ${c.length} remove buttons for group "${t}"`),c.forEach(a=>{let u=a.getAttribute("data-cd-repeat-remove");u&&console.log(`\u{1F517} Remove button references group: "${u}" (should be "${t}")`),a.removeEventListener("click",Z),a.addEventListener("click",Z)}),X(l),Q(l)}function Me(t){console.log("\u{1F5B1}\uFE0F Add button clicked!",t.target),t.preventDefault();let e=t.target,n=e.closest("[data-cd-repeat-add]")||e.closest("[data-cd-add-row]");if(console.log("\u{1F50D} Event details:",{clickedElement:e.tagName,clickedClass:e.className,foundButton:!!n,buttonAttr:n?n.getAttribute("data-cd-repeat-add")||n.getAttribute("data-cd-add-row"):"none"}),!n){console.error("\u274C No add button found from clicked element");return}let o=n.getAttribute("data-cd-repeat-add")||n.getAttribute("data-cd-add-row");if(console.log("\u{1F50D} Searching for container from button:",{button:n.tagName,buttonClass:n.className,groupName:o}),!o){console.error("\u274C No group name found on add button");return}let s=document.querySelector(`[data-cd-repeat-group="${o}"]`);if(console.log("\u{1F50D} Container lookup result:",{groupName:o,containerFound:!!s}),!s){console.error(`\u274C No container found for group "${o}"`);return}console.log(`\u{1F4DD} Found container for group: "${o}"`);let r=J.get(o);if(console.log("\u{1F4E6} Retrieved group:",!!r),!r){console.error(`\u274C No group found in activeGroups for "${o}"`);return}Pt(r)}function Z(t){t.preventDefault();let e=t.target,n=e.closest("[data-cd-repeat-group]");if(!n)return;let o=n.getAttribute("data-cd-repeat-group");if(!o)return;let s=J.get(o);if(!s)return;let r=kt(s,e);r&&Ot(s,r.row)}function Pt(t){if(console.log(`\u2795 Adding new row to group "${t.groupName}" (currently ${t.rows.length} rows)`),t.rows.length>=5){console.log(`\u26A0\uFE0F Maximum rows reached for group "${t.groupName}" (5 rows max)`),t.addButton&&(t.addButton.style.opacity="0.5",t.addButton.style.pointerEvents="none",console.log(`\u{1F6AB} Add button disabled for group "${t.groupName}"`));return}let e=Array.from(t.container.querySelectorAll("[data-cd-repeat-row]:not([data-cd-repeat-template])")).find(i=>i.style.display!=="none");if(!e){console.error("\u274C No visible row found to clone");return}let n=e.cloneNode(!0);n.querySelectorAll("input, select, textarea").forEach(i=>{let l=i;l.value="";let c=l.getAttribute("data-input");if(c){console.log(`\u2795 Applying formatting to new input: data-input="${c}"`);let a=Le(c);if(a){let u=Ie(a);if(u){l.__maskito&&l.__maskito.destroy();let d=new L(l,u);l.__maskito=d,l.dispatchEvent(new CustomEvent("cd:inputformat:bound",{bubbles:!0})),console.log(`\u2705 Maskito applied to new input with data-input="${c}"`)}}}});let s=n;s.style.display="",s.removeAttribute("aria-hidden"),console.log(`\u2795 New row visibility: display="${s.style.display}"`),t.container.appendChild(n),t.rows.push(n);let r=n.querySelectorAll("[data-cd-remove-row], [data-cd-repeat-remove]");console.log(`\u2795 Attaching ${r.length} remove button listeners to new row`),r.forEach(i=>{i.addEventListener("click",Z)}),X(t),Q(t),console.log(`\u2795 Row added successfully, new total: ${t.rows.length} rows`),n.dispatchEvent(new CustomEvent("cd:row:added",{bubbles:!0,detail:{groupName:t.groupName,rowIndex:t.rows.length-1}}))}function X(t){t.rows.forEach((e,n)=>{let o=n+1;e.querySelectorAll("[data-repeat-name]").forEach(l=>{let c=l.getAttribute("data-repeat-name");if(c){let a=t.namePattern.replace("{i}",o.toString()).replace("{field}",c);l.name=a}}),e.querySelectorAll("[id]").forEach(l=>{let c=l.getAttribute("data-original-id");c?l.id=`${c}-${o}`:l.id.endsWith(`-${o}`)||(l.setAttribute("data-original-id",l.id),l.id=`${l.id}-${o}`)}),e.querySelectorAll("label[for]").forEach(l=>{let c=l.getAttribute("data-original-for");if(c)l.htmlFor=`${c}-${o}`;else{let a=l.htmlFor;a.endsWith(`-${o}`)||(l.setAttribute("data-original-for",a),l.htmlFor=`${a}-${o}`)}})}),t.rows.forEach(e=>{e.querySelectorAll("input, select, textarea").forEach(o=>{o.dispatchEvent(new Event("input",{bubbles:!0}))})}),ee()}function Q(t){console.log(`\u{1F4CA} Updating summaries for group "${t.groupName}" (${t.rows.length} rows)`);let e=document.querySelectorAll(`[data-summary-for="${t.groupName}"]`);console.log(`\u{1F4CA} Found ${e.length} summary container(s) for group "${t.groupName}"`),e.forEach((n,o)=>{let s=n.querySelector("[data-summary-template]");if(!s){console.warn(`\u{1F4CA} No template found in summary container ${o} for group "${t.groupName}"`);return}let r=n.querySelectorAll("[data-summary-row]");console.log(`\u{1F4CA} Removing ${r.length} existing summary rows from container ${o}`),r.forEach(i=>i.remove()),console.log(`\u{1F4CA} Creating ${t.rows.length} new summary rows for container ${o}`),t.rows.forEach((i,l)=>{let c=l+1,a=s.cloneNode(!0);a.removeAttribute("data-summary-template"),a.setAttribute("data-summary-row","");let u=a.querySelectorAll("[data-input-field]");console.log(`\u{1F4CA} Processing ${u.length} field elements in summary row ${c}`),u.forEach(d=>{let g=d.getAttribute("data-input-field");if(g){let m=g.replace("{i}",c.toString());d.setAttribute("data-input-field",m),console.log(`\u{1F4CA} Updated field: ${g} \u2192 ${m}`)}}),n.appendChild(a)})}),ee(),typeof window.TryFormly?.refresh=="function"?(console.log("\u{1F4CA} Triggering TryFormly.refresh()"),window.TryFormly.refresh()):console.log("\u{1F4CA} TryFormly.refresh() not available")}function ee(){console.log("\u{1F504} Syncing all summary fields...");let t=document.querySelectorAll("[data-cd-input-field]");console.log(`\u{1F504} Found ${t.length} summary field elements`),t.forEach((e,n)=>{let o=e.getAttribute("data-cd-input-field");o&&(console.log(`\u{1F504} Syncing field ${n+1}: "${o}"`),Y(e,o))})}function Y(t,e){let n=null;if(console.log(`\u{1F50D} Syncing summary field: "${e}"`),e.includes("{i}")){console.log(`\u{1F50D} Templated field detected: "${e}"`);let r=t.closest("[data-summary-row]");if(r){let i=r.parentElement,c=Array.from(i?.querySelectorAll("[data-summary-row]")||[]).indexOf(r)+1,a=e.replace("{i}",c.toString());console.log(`\u{1F50D} Resolved templated field: "${e}" \u2192 "${a}"`),e=a}else{console.log(`\u{1F50D} Could not resolve templated field "${e}" - no summary row context found`);return}}let o=[`input[name="${e}"]`,`select[name="${e}"]`,`textarea[name="${e}"]`,`input[id="${e}"]`,`select[id="${e}"]`,`textarea[id="${e}"]`];for(let r of o)if(n=document.querySelector(r),n){console.log(`\u{1F50D} Found source using selector: ${r}`);break}if(!n){console.log(`\u{1F50D} Direct match failed for field: "${e}"`);let i=Array.from(document.querySelectorAll("input[name], select[name], textarea[name]")).slice(0,5).map(l=>l.getAttribute("name"));console.log("\u{1F50D} Sample available input names:",i);return}console.log(`\u{1F50D} Found source element for "${e}":`,n.tagName,n.type||"");let s="";if(n.type==="radio"){let r=document.querySelector(`input[name="${e}"]:checked`);s=r?r.value:""}else n.type==="checkbox"?s=n.checked?"Yes":"No":s=n.value;if(t.textContent=s||"[Not specified]",console.log(`\u2705 Updated summary for "${e}": "${s}"`),!n.__summaryListenerAdded){let r=n.type==="radio"||n.type==="checkbox"?"change":"input";n.addEventListener(r,()=>{console.log(`\u{1F504} Field "${e}" changed, updating summary...`),Y(t,e)}),n.type==="radio"&&document.querySelectorAll(`input[name="${e}"]`).forEach(l=>{l.__summaryListenerAdded||(l.addEventListener("change",()=>{console.log(`\u{1F504} Radio "${e}" changed, updating summary...`),Y(t,e)}),l.__summaryListenerAdded=!0)}),n.__summaryListenerAdded=!0,console.log(`\u{1F3A7} Added ${r} listener for field "${e}"`)}}function kt(t,e){for(let n=0;n<t.rows.length;n++){let o=t.rows[n];if(o.contains(e))return{row:o,index:n}}return null}function Ot(t,e){if(console.log(`\u2796 Removing row from group "${t.groupName}" (currently ${t.rows.length} rows)`),t.rows.length<=1){console.warn("Cannot remove last row from group:",t.groupName);return}let n=t.rows.indexOf(e);if(n===-1){console.warn("Target row not found in group:",t.groupName);return}console.log(`\u2796 Removing row at index ${n}`),e.remove(),t.rows.splice(n,1),t.rows.length<5&&t.addButton&&(t.addButton.style.opacity="",t.addButton.style.pointerEvents="",console.log(`\u2705 Add button re-enabled for group "${t.groupName}"`)),X(t),Q(t),console.log(`\u2796 Row removed successfully, new total: ${t.rows.length} rows`),e.dispatchEvent(new CustomEvent("cd:row:removed",{bubbles:!0,detail:{groupName:t.groupName,rowIndex:n,removedRow:e}}))}function Ft(t,e){Ce(t,e)}document.addEventListener("form-wrapper-visibility:shown",t=>{t.target.querySelectorAll("[data-cd-repeat-group]").forEach(o=>{let s=o.getAttribute("data-cd-repeat-group");s&&Ft(s,o)})});function K(){console.log("\u{1F680} CDFormLibrary Initialize Starting..."),console.log("\u{1F50D} VERSION:",Re),console.log("\u{1F50D} DOM Ready State:",document.readyState),console.log("\u{1F50D} Document Title:",document.title),console.log("\u{1F50D} Current URL:",window.location.href);let t=document.querySelectorAll('form[data-cd-form="true"]');if(console.log('\u{1F50D} Found forms with data-cd-form="true":',t.length),t.length===0){console.warn('\u26A0\uFE0F No forms found with data-cd-form="true"');let e=document.querySelectorAll("form");console.log("\u{1F50D} Total forms on page:",e.length),e.length>0&&(console.log("\u{1F50D} First form element:",e[0]),console.log("\u{1F50D} First form attributes:",Array.from(e[0].attributes).map(n=>`${n.name}="${n.value}"`)));return}t.forEach((e,n)=>{let o=e;console.log(`
\u{1F4CB} Processing Form ${n+1}:`,o),console.log("\u{1F4CB} Form ID:",o.id||"NO ID"),console.log("\u{1F4CB} Form Classes:",o.className||"NO CLASSES");try{console.log("\u{1F3AF} Step 1: Initializing input formatting..."),Tt(o),console.log("\u{1F3AF} Step 2: Initializing form wrapper visibility..."),_t(),console.log("\u{1F3AF} Step 3: Initializing dynamic rows..."),Nt(),console.log("\u{1F3AF} Step 4: Initializing summary field synchronization..."),ee(),console.log("\u{1F3AF} Step 5: Dispatching validation event..."),o.dispatchEvent(new CustomEvent("cdForm:validated",{bubbles:!0})),console.log("\u2705 Form initialization completed successfully")}catch(s){console.error("\u274C Error enhancing form:",s),console.error("\u274C Stack trace:",s.stack)}}),console.log("\u{1F3C1} CDFormLibrary Initialize Complete")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",K):K();window.CDFormLibrary={version:Re,initialize:K};})();
